<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1'>
        <title>Bomberman</title>
    </head>
    <body>
      <style>
        body { padding: 0; margin: 0; }
        canvas { background: white; display: block; margin: 0 auto; }
      </style>
      <div id='app'></div>
      <canvas id="myCanvas" width="480" height="320"></canvas>
      <script src="/bundle.js"></script>
      <script>
        const canvas = document.getElementById("myCanvas");
        const ctx = canvas.getContext("2d");
        
        const app = window.Elm.Main.embed(
          document.getElementById('app'),
          {
            width: parseInt(canvas.getAttribute('width'), 10),
            height: parseInt(canvas.getAttribute('height'), 10)
          }
        )
        
        const images = {}
        
        app.ports.updateEntity.subscribe(function (args) {
            const [
                spriteSheet,
                xSrc,
                ySrc,
                width,
                height,
                xPos,
                yPos
            ] = args
            
            if (!images[spriteSheet]) {
                images[spriteSheet] = new Image()
                images[spriteSheet].src = spriteSheet
            }

            // context.drawImage(img, sx, sy, sw, sh, dx, dy, dw, dh)
            ctx.drawImage(images[spriteSheet], xSrc, ySrc, width, height, xPos, yPos, width, height)
        })
        
        app.ports.clear.subscribe(function () {

        })
      </script>
    </body>
</html>
